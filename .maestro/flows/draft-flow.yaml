# Maestro E2E Test: Draft Flow
# Tests the complete draft experience
#
# To run: maestro test .maestro/flows/draft-flow.yaml

appId: com.gmsim.app

---
# Test: Draft Room Flow
# Prerequisites: Game in offseason draft phase

- launchApp

# Navigate to existing game in draft phase (or create new and sim to draft)
- tapOn: "Continue Game"

# === ENTER DRAFT ROOM ===
- assertVisible: "Draft"
- tapOn: "Draft"

# Verify draft room elements
- assertVisible: "Round 1"
- assertVisible: "On the Clock"

# === WAIT FOR USER'S PICK ===
# If not user's pick, wait or simulate AI picks
- runFlow:
    when:
      notVisible: "Your Pick"
    commands:
      - tapOn: "Auto-Advance"
      - extendedWaitUntil:
          visible: "Your Pick"
          timeout: 60000

# === MAKE A DRAFT PICK ===
- assertVisible: "Available Prospects"

# View a prospect
- tapOn:
    index: 0
    below: "Available Prospects"

# Check prospect details
- assertVisible: "Overall Grade"
- assertVisible: "Position"
- assertVisible: "Draft"

# Draft the prospect
- tapOn: "Draft"

# Confirm the pick
- assertVisible: "Confirm Pick"
- tapOn: "Confirm"

# Verify pick was made
- assertVisible: "Pick Complete"

# === CONTINUE DRAFT ===
# Wait for next user pick or end of draft
- extendedWaitUntil:
    visible:
      anyOf:
        - "Your Pick"
        - "Draft Complete"
    timeout: 120000

# === DRAFT COMPLETE ===
- runFlow:
    when:
      visible: "Draft Complete"
    commands:
      - assertVisible: "Your Picks"
      - tapOn: "View Draft Summary"
      - assertVisible: "Draft Grades"
      - tapOn: "Continue"
