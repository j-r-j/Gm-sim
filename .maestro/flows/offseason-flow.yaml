# Maestro E2E Test: Offseason Flow
# Tests all 12 offseason phases
#
# To run: maestro test .maestro/flows/offseason-flow.yaml

appId: com.nflgmsim.app

---
# Test: Complete Offseason Flow
# Prerequisites: Game in offseason phase

- launchApp
- tapOn: "Continue Game"

# === PHASE 1: SEASON RECAP ===
- assertVisible: "Season Recap"
- assertVisible: "Final Record"
- assertVisible: "Season Awards"
- tapOn: "Continue"

# === PHASE 2: COACHING CHANGES ===
- assertVisible: "Coaching Staff"
- assertVisible:
    anyOf:
      - "Head Coach"
      - "Review Staff"

# View coaching staff
- tapOn: "Review Staff"
- assertVisible: "Coordinators"

# Option to fire coach (don't actually fire)
- back
- tapOn: "Continue"

# === PHASE 3: CONTRACT DECISIONS ===
- assertVisible: "Contract Decisions"
- assertVisible: "Expiring Contracts"

# View expiring contracts list
- scrollUntilVisible:
    element: "Continue"
    direction: DOWN

- tapOn: "Continue"

# === PHASE 4: COMBINE ===
- assertVisible: "NFL Combine"
- assertVisible: "Top Prospects"

# View a prospect
- tapOn:
    index: 0
    below: "Top Prospects"

- assertVisible: "40-Yard Dash"
- assertVisible: "Bench Press"
- back
- tapOn: "Continue"

# === PHASE 5: FREE AGENCY ===
- assertVisible: "Free Agency"
- assertVisible: "Available Players"
- assertVisible: "Cap Space"

# View available free agents
- tapOn: "Browse Free Agents"
- assertVisible:
    text: ".*Age.*"
    regex: true

# Make an offer (optional)
- back
- tapOn: "Continue"

# === PHASE 6: DRAFT ===
- assertVisible: "NFL Draft"
- tapOn: "Enter Draft Room"

# Draft room tested in separate flow - just verify we can enter
- assertVisible: "Round 1"
- tapOn: "Exit Draft"

# === PHASE 7: UDFA ===
- assertVisible: "Undrafted Free Agents"
- tapOn: "Continue"

# === PHASE 8: OTAs ===
- assertVisible: "OTAs"
- assertVisible: "Organized Team Activities"
- tapOn: "Continue"

# === PHASE 9: TRAINING CAMP ===
- assertVisible: "Training Camp"
- assertVisible: "Position Battles"
- tapOn: "Continue"

# === PHASE 10: PRESEASON ===
- assertVisible: "Preseason"
- tapOn: "Simulate Preseason"

- extendedWaitUntil:
    visible: "Preseason Complete"
    timeout: 30000

- tapOn: "Continue"

# === PHASE 11: FINAL CUTS ===
- assertVisible: "Final Cuts"
- assertVisible: "Roster: 53"

# Make cuts if needed
- tapOn:
    anyOf:
      - "Auto Cut"
      - "Continue"

# === PHASE 12: SEASON START ===
- assertVisible: "Season Start"
- assertVisible: "Week 1"
- tapOn: "Begin Season"

# Verify we're back at dashboard for new season
- assertVisible: "Week 1"
- assertVisible: "Play Week 1"
